$InstallationUrl = "https://cmedirect.cmegroup.com/client/CMEDirect.application"
$ShortcutName = "CME Direct.lnk"
$DesktopPath = "C:\Users\Public\Desktop"
$ShortcutPath = Join-Path $DesktopPath $ShortcutName

try {
    $Shell = New-Object -ComObject Shell.Application
    $Directory = $Shell.NameSpace($DesktopPath)
    
    if (!(Test-Path $ShortcutPath)) {
        New-Item -Path $ShortcutPath -ItemType File -Force
    }

    $Shortcut = $Directory.ParseName($ShortcutName).GetLink
    $Shortcut.Path = "C:\Windows\System32\rundll32.exe"
    $Shortcut.Arguments = "dfshim.dll,ShOpenVerbApplication $InstallationUrl"
    $Shortcut.SetIconLocation("C:\Windows\System32\shell32.dll", 14)
    $Shortcut.Save()

    Write-Host "Shortcut created successfully."
}
catch {
    Write-Host "Unable to create shortcut"
    Write-Output $_
}
